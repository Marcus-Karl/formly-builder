<div #emptyAnchor></div>

<div
  cdkDrag
  class="drag-container"
  cdkDragBoundary=".cdk-overlay-container"
  cdkDragRootElement=".cdk-overlay-pane">

  <div
    cdkDragHandle
    [cdkDragHandleDisabled]="mouseIsHovered">

    <div class="dialog-header">
      <h2 mat-dialog-title role="heading" aria-level="2">{{ categoryLabel}}</h2>

      <button mat-icon-button (click)="toggleSize()" (mouseenter)="mouseIsHovered = true" (mouseleave)="mouseIsHovered = false">
        <mat-icon *ngIf="!isFullScreen">fullscreen</mat-icon>
        <mat-icon *ngIf="isFullScreen">close_fullscreen</mat-icon>
      </button>
    </div>

    <div mat-dialog-content>
      <formly-field [field]="field" [ngClass]="field.props?.classes"></formly-field>
    </div>

    <mat-dialog-actions #footer [align]="'end'">
      <ng-container *ngIf="!field.formControl?.disabled && isNewlyAdded">
        <button mat-flat-button (click)="resetAndClose()" extended>
          <mat-icon>undo</mat-icon>
          Remove & Close
        </button>

        <button
          mat-raised-button
          color="primary"
          [disabled]="field.formControl?.invalid"
          [hidden]="!categorySelectionComplete"
          (click)="updateAndClose()">
          Save & Close
        </button>

        <button
          *ngIf="!categorySelectionComplete && categoryField;"
          mat-raised-button color="primary"
          [disabled]="categoryField.formControl?.invalid"
          (click)="onSelectedCategory()">
          Continue
        </button>
      </ng-container>

      <button *ngIf="!(!field.formControl?.disabled && isNewlyAdded)" mat-raised-button color="primary" (click)="dialogRef.close()" cdkFocusInitial>
        Close
      </button>
    </mat-dialog-actions>
  </div>
</div>