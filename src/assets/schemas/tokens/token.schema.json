{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "$id": "/assets/schemas/tokens/token",
  "type": "array",
  "title": "Tokens",
  "minItems": 0,
  "widget": {
    "formlyConfig": {
      "type": "token-page",
      "defaultValue": []
    }
  },
  "items": [
    {
      "type": "object",
      "widget": {
        "formlyConfig": {
          "type": "tab-form",
          "defaultValue": {},
          "templateOptions": {
            "hideButtons": true
          }
        }
      },
      "properties": {
        "category": {
          "type": "string",
          "title": "Select Token Type",
          "widget": {
            "formlyConfig": {
              "type": "select",
              "defaultValue": "",
              "templateOptions": {
                "options": []
              },
              "hideExpression": "true"
            }
          }
        },
        "basic": {
          "type": "object",
          "title": "Token",
          "widget": {
            "formlyConfig": {
              "className": "formly-field-tab",
              "defaultValue": {}
            }
          },
          "properties": {
            "fieldReference": {
              "type": "string",
              "title": "Field Reference",
              "widget": {
                "formlyConfig": {
                  "type": "select",
                  "defaultValue": "",
                  "templateOptions": {
                    "options": []
                  },
                  "expressionProperties": {
                    "templateOptions.required": "field.parent.parent.model.category === 'answer-based'"
                  },
                  "hideExpression": "field.parent.parent.model.category !== 'answer-based'"
                }
              }
            },
            "tokenName": {
              "type": "string",
              "title": "Token Name/Identifier",
              "widget": {
                "formlyConfig": {
                  "type": "input",
                  "defaultValue": "",
                  "className": "formly-field",
                  "validators": {
                    "validation": [
                      "valid-name"
                    ]
                  }
                }
              }
            },
            "tokenType": {
              "type": "string",
              "title": "Token Type",
              "widget": {
                "formlyConfig": {
                  "type": "input",
                  "defaultValue": "",
                  "expressionProperties": {
                    "model.tokenType": "field.options.formState.builder.functions.getFieldTypeForReference(field.options.formState, model.fieldReference) || ''"
                  },
                  "hideExpression": "field.parent.parent.model.category === 'answer-based'"
                }
              }
            },
            "tokenSubType": {
              "type": "string",
              "title": "Token Sub Type",
              "widget": {
                "formlyConfig": {
                  "type": "input",
                  "defaultValue": "",
                  "expressionProperties": {
                    "model.tokenSubType": "field.options.formState.builder.functions.getFieldSubTypeForReference(field.options.formState, model.fieldReference) || ''"
                  },
                  "hideExpression": "true"
                }
              }
            }
          },
          "required": [
            "tokenName"
          ]
        },
        "advanced": {
          "type": "object",
          "title": "Advanced",
          "widget": {
            "formlyConfig": {
              "className": "formly-field-tab fill",
              "defaultValue": {}
            }
          },
          "properties": {
            "format": {
              "type": "string",
              "title": "Custom Format",
              "widget": {
                "formlyConfig": {
                  "className": "formly-field",
                  "type": "input",
                  "defaultValue": ""
                }
              }
            }
          }
        }
      },
      "required": [
        "category"
      ]
    }
  ]
}